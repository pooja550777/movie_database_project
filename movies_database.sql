create database movies_database;


CREATE TABLE ACTOR (
ACT_ID INTEGER PRIMARY KEY,
ACT_NAME VARCHAR(20),
ACT_GENDER CHAR(1));

CREATE TABLE DIRECTOR(
DIR_ID INTEGER PRIMARY KEY,
DIR_NAME VARCHAR(20),
DIR_PHONE INTEGER);

CREATE TABLE MOVIES(
MOV_ID INTEGER PRIMARY KEY,
MOV_TITLE VARCHAR(25),
MOV_YEAR INTEGER,
MOV_LANG VARCHAR(15),
DIR_ID INTEGER,
FOREIGN KEY (DIR_ID) REFERENCES DIRECTOR(DIR_ID));

CREATE TABLE MOVIE_CAST(
ACT_ID INTEGER,
MOV_ID INTEGER,
ROLE VARCHAR(10),
PRIMARY KEY (ACT_ID,MOV_ID),
FOREIGN KEY (ACT_ID) REFERENCES ACTOR(ACT_ID),
FOREIGN KEY (MOV_ID) REFERENCES MOVIES(MOV_ID));


CREATE TABLE RATING(
MOV_ID INTEGER PRIMARY KEY,
REV_STARS VARCHAR(25),
FOREIGN KEY (MOV_ID) REFERENCES MOVIES(MOV_ID));


INSERT INTO ACTOR VALUES(1,'Allu Arjun','M');
INSERT INTO ACTOR VALUES(2,'Keerthy Suresh','F');
INSERT INTO ACTOR VALUES(3,'Rashmika Mandanna','F');
INSERT INTO ACTOR VALUES(4,'Mahesh Babu','M');
INSERT INTO ACTOR VALUES(5,'Prabhas','M');

INSERT INTO DIRECTOR VALUES(10,'Shankar',918181818);
INSERT INTO DIRECTOR VALUES(20,'HITCHCOCK',918181812);
INSERT INTO DIRECTOR VALUES(30,'Selvaraghavan',918181813);
INSERT INTO DIRECTOR VALUES(40,'Yogaraj Bhat',918181814);
INSERT INTO DIRECTOR VALUES(50,'Gautham Menon',918181815);


INSERT INTO MOVIES VALUES(1001,'Okkadu',2017,'KANNADA',10);
INSERT INTO MOVIES VALUES(1002,'Athadu ',2015,'TELUGU',20);
INSERT INTO MOVIES VALUES(1003,'Chakram',2008,'KANNADA',30);
INSERT INTO MOVIES VALUES(1004,'geeta govindam',2011,'HINDI',40);
INSERT INTO MOVIES VALUES(1005,' Sarkaru Vaari Paata',2012,'TAMIL',50);


SELECT * FROM MOVIE_CAST;
INSERT INTO MOVIE_CAST VALUES(1,1002,'HERO');
INSERT INTO MOVIE_CAST VALUES(2,1001,'HEROINE');
INSERT INTO MOVIE_CAST VALUES(3,1003,'HEROINE');
INSERT INTO MOVIE_CAST VALUES(4,1002,'HERO');
INSERT INTO MOVIE_CAST VALUES(5,1004,'HERO');

SELECT * FROM RATING;
INSERT INTO RATING VALUES(1001,4);
INSERT INTO RATING VALUES(1002,2);
INSERT INTO RATING VALUES(1003,5);
INSERT INTO RATING VALUES(1004,4);
INSERT INTO RATING VALUES(1005,3);



/* List the titles of all movies directed by â€žHitchcock*/
SELECT MOV_TITLE
FROM MOVIES
WHERE DIR_ID = (SELECT DIR_ID
FROM DIRECTOR
WHERE DIR_NAME='HITCHCOCK');

/* Find the movie names where one or more actors acted in two or more movies*/


SELECT MOV_TITLE
FROM MOVIES M,MOVIE_CAST MC
WHERE M.MOV_ID=MC.MOV_ID AND ACT_ID IN (SELECT ACT_ID
FROM MOVIE_CAST GROUP BY ACT_ID
HAVING COUNT(ACT_ID)>1)
GROUP BY MOV_TITLE
HAVING COUNT(*)>1;

SELECT ACT_NAME
FROM ACTOR A
JOIN MOVIE_CAST C
ON A.ACT_ID=C.ACT_ID
JOIN MOVIES M
ON C.MOV_ID=M.MOV_ID
WHERE M.MOV_YEAR NOT BETWEEN 2000 AND 2015;


SELECT MOV_TITLE,MAX(REV_STARS)
FROM MOVIES
INNER JOIN RATING USING (MOV_ID)
GROUP BY MOV_TITLE
HAVING MAX(REV_STARS)>0
ORDER BY MOV_TITLE;


UPDATE RATING
SET REV_STARS=5
WHERE MOV_ID IN (SELECT MOV_ID FROM MOVIES
WHERE DIR_ID IN (SELECT DIR_ID
FROM DIRECTOR
WHERE DIR_NAME='Selvaraghavan'));
